<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<title>
  
    开发日志 3# - 玩家动作&amp;战斗进度
  
</title>

<meta name="description" content="大家好，我是狼，这周又轮到我写devblog了……
这两周的时间我完成了战斗系统部分的大致构建，也解决了很多在之前做过的原型没解决的问题。首先看看现在的结果吧：

现在的战斗总算有点拳拳到肉并且流畅转换的感觉了。策划层面，我们在这两周做了很多方向性的修改，其中的大多修改都是为了保证流畅快速。例如，玩家的前后闪步本来是前后滚翻，但为了让玩家可以快速的接近怪物/躲避攻击，修改成了闪步；接战时添加攻击判">
<meta property="og:type" content="article">
<meta property="og:title" content="开发日志 3# - 玩家动作&战斗进度">
<meta property="og:url" content="http://www.project-gearbox.net/zh-cn/2017/devblog-3/index.html">
<meta property="og:site_name" content="Project Gearbox">
<meta property="og:description" content="大家好，我是狼，这周又轮到我写devblog了……
这两周的时间我完成了战斗系统部分的大致构建，也解决了很多在之前做过的原型没解决的问题。首先看看现在的结果吧：

现在的战斗总算有点拳拳到肉并且流畅转换的感觉了。策划层面，我们在这两周做了很多方向性的修改，其中的大多修改都是为了保证流畅快速。例如，玩家的前后闪步本来是前后滚翻，但为了让玩家可以快速的接近怪物/躲避攻击，修改成了闪步；接战时添加攻击判">
<meta property="og:image" content="http://www.project-gearbox.net/img/devblog-3-1.gif">
<meta property="og:image" content="http://www.project-gearbox.net/img/devblog-3-2.gif">
<meta property="og:image" content="http://www.project-gearbox.net/img/combo-editor.jpg">
<meta property="og:updated_time" content="2017-03-23T06:52:47.293Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="开发日志 3# - 玩家动作&战斗进度">
<meta name="twitter:description" content="大家好，我是狼，这周又轮到我写devblog了……
这两周的时间我完成了战斗系统部分的大致构建，也解决了很多在之前做过的原型没解决的问题。首先看看现在的结果吧：

现在的战斗总算有点拳拳到肉并且流畅转换的感觉了。策划层面，我们在这两周做了很多方向性的修改，其中的大多修改都是为了保证流畅快速。例如，玩家的前后闪步本来是前后滚翻，但为了让玩家可以快速的接近怪物/躲避攻击，修改成了闪步；接战时添加攻击判">
<meta name="twitter:image" content="http://www.project-gearbox.net/img/devblog-3-1.gif">


  <link rel="alternative" href="/atom.xml" title="Project Gearbox" type="application/atom+xml">



  <link rel="icon" href="/favicon.png">


<link rel="stylesheet" href="/perfect-scrollbar/css/perfect-scrollbar.min.css">
<link rel="stylesheet" href="/styles/main.css">






</head>
<body
  
  >
  <div class="mobile-header">
  <button class="sidebar-toggle" type="button">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </button>
  <a class="title" href="/">Project Gearbox</a>
</div>

  <div class="main-container">
    <div class="sidebar">
  <div class="header">
    <h1 class="title"><a href="/">Project Gearbox</a></h1>
    
    <div class="info">
      <div class="content">
        
        
      </div>
      
        <div class="avatar">
          
            <a href="/"><img src="/img/GB-icon.png"></a>
          
        </div>
      
    </div>
  </div>
  <div class="body">
    
      
        <ul class="nav">
          
            
              <li>
              <a href="/zh-cn/" title="Home">Home</a>
              </li>
            
          
        </ul>
      
        <ul class="nav">
          
            
              <li class="category-list-container">
                <a href="javascript:;">Blog</a>
                <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/zh-cn/categories/devblog/">devblog</a><span class="category-list-count">6</span></li></ul>
              </li>
            
          
        </ul>
      
        <ul class="nav">
          
            
              <li>
              <a href="/zh-cn/media/index.html" title="Media">Media</a>
              </li>
            
          
        </ul>
      
        <ul class="nav">
          
            
              <li>
              <a href="/zh-cn/about/index.html" title="About">About</a>
              </li>
            
          
        </ul>
      
      <ul class="nav">
      <br><br><br><br>
      <li class="tag-list-container">
          <a href="/zh-cn/index.html" class="lang-select">简体中文</a>
      </li>    
      </ul>
    
  </div>
</div>

    <div class="main-content">
      
        <div style="max-width: 1000px">
      
          <article id="post-devblog-3" class="article article-type-post">
  
    <h1 class="article-header">
      开发日志 3# - 玩家动作&战斗进度
    </h1>
  
  

  <div class="article-info">
    <span class="article-date">
  2017-03-23
</span>

    
	<span class="article-category tagcloud">
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/zh-cn/categories/devblog/">devblog</a></li></ul>
	</span>


    

  </div>
  <div class="article-entry">
    <p>大家好，我是狼，这周又轮到我写devblog了……</p>
<p>这两周的时间我完成了战斗系统部分的大致构建，也解决了很多在之前做过的原型没解决的问题。首先看看现在的结果吧：</p>
<p><img src="/img/devblog-3-1.gif" alt=""><br><img src="/img/devblog-3-2.gif" alt=""></p>
<p>现在的战斗总算有点拳拳到肉并且流畅转换的感觉了。策划层面，我们在这两周做了很多方向性的修改，其中的大多修改都是为了保证<strong>流畅快速</strong>。例如，玩家的前后闪步本来是前后滚翻，但为了让玩家可以快速的接近怪物/躲避攻击，修改成了闪步；接战时添加攻击判定以快速击晕怪物，等等。</p>
<p>战斗部分的实现由于之前有很多相关思考，所以基本是一步到位，这里总结一下一些实现战斗过程中对体验比较重要的点。</p>
<a id="more"></a>
<h2 id="1-输入接受和Combo"><a href="#1-输入接受和Combo" class="headerlink" title="1. 输入接受和Combo"></a>1. 输入接受和Combo</h2><p>这里主要说的是对玩家输入的处理。我们在玩家处用的是Unity的Mechanim，它是一个HFSM（多层有限状态机）结构。假如要实现一个玩家从站立-攻击的转换，最简单的只需要添加一条转换边：</p>
<blockquote>
<p>fight_idle –(按下攻击键)-&gt; attack</p>
</blockquote>
<p>这样可以工作，但它对动作游戏并不够。例如，我们闪步后是回到站立，但如果玩家在闪步快要结束的时候按下攻击，这个输入就会被<strong>忽略</strong>，这样的忽略是反直觉并且影响体验的（尤其是有的动作末尾是过渡帧，对玩家来说，在这几帧无法分辨是在上一个动作还是下一个）。</p>
<p>因此，我们应该尽可能避免输入被忽略的情况出现。目前暂时是手动在各个动画内手动的添加延迟输入处理的脚本，感觉需要一个更加自动化的解决方案，暂时还在考虑中。</p>
<p>接下来说说Combo。Combo的实现原理其实相当简单，用一个结构来存Combo的转换信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">[Serializable]</div><div class="line">public class StateTransition &#123;</div><div class="line">	public string state;</div><div class="line">	public int startFrame;</div><div class="line">	public int startTransitionFrame;</div><div class="line">	public string buttonName;</div><div class="line">&#125;</div><div class="line"></div><div class="line">[Serializable]</div><div class="line">public class Combo &#123;</div><div class="line">	public string name;</div><div class="line">	public List&lt;StateTransition&gt; list;</div><div class="line"></div><div class="line">	[NonSerialized]</div><div class="line">	public int progress; // Current state index of combo.</div><div class="line"></div><div class="line">	[NonSerialized]</div><div class="line">	public bool triggeredButton = false; // Have we triggered button in current state.</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>加上可视化编辑器，就可以这么编辑了：</p>
<p><img src="/img/combo-editor.jpg" alt=""></p>
<p>在运行时，我们对每个combo存一个“运行进度”索引，并根据当前动作和输入对运行进度进行更新。每次动作结束，如果玩家按下了对应的按键，就更新combo进度，并转换动作，这样就实现了combo。</p>
<h2 id="2-反馈感优化"><a href="#2-反馈感优化" class="headerlink" title="2. 反馈感优化"></a>2. 反馈感优化</h2><p>我重点考察了几个方面，来进行游戏反馈感觉的优化：</p>
<h3 id="时停"><a href="#时停" class="headerlink" title="时停"></a>时停</h3><p>在玩家攻击到怪物的时候，会给一个短暂的时停，这个时停和当前攻击的’威力’成正相关。这样就会给一种【真的打到肉上了】的感觉，也在润色上体现出各个攻击的区别。</p>
<h3 id="位移和击退"><a href="#位移和击退" class="headerlink" title="位移和击退"></a>位移和击退</h3><p>在Gearbox里，我们把玩家在战斗中位移的控制作为一个非常核心的玩点。玩家在攻击时会随步伐主动前进，被攻击时则会有向后的击退。</p>
<h3 id="控制感"><a href="#控制感" class="headerlink" title="控制感"></a>控制感</h3><p>老版本的原型中，我们把有的动画设置的很长，从而造成了一种滞空感和迟滞感。对于那些会剥夺玩家操作的动作（e.g. 攻击，跳跃，爬墙），我们应该考虑尽可能减少它们的占用时间——即便这和现实状况不符。如果玩家被剥夺操作的时间过长，很容易带来心流的打断。</p>
<h1 id="Summing-Up"><a href="#Summing-Up" class="headerlink" title="Summing Up"></a>Summing Up</h1><p>总而言之，ACT的战斗是一个即时性非常强的东西。要做到流畅爽快，必须在反馈方面下大工夫，提高玩家的操作感。</p>
<p>接下来我们应该会尝试加入更多的场景交互，以及完成一些具体的场景。这些内容和怪物结合起来，我们离一个实际可玩的关卡也更近了一步。敬请期待！</p>

  </div>
  <footer class="article-footer">
    

    

  </footer>
</article>





<div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
<script>
  var cloudTieConfig = {
    url: document.location.href, 
    sourceId: "",
    productKey: "3367a31d726c41f5a11acff7b7654865",
    target: "cloud-tie-wrapper"
  };
</script>
<script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script>

          <div class="main-footer">
  
    © 2017 Project Gearbox - Powered by <a href="http://hexo.io" target="_blank">Hexo</a> - Theme <a href="https://github.com/denjones/hexo-theme-chan" target="_blank">Chan</a>
  
</div>

      
        </div>
      
    </div>
  </div>
  <script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>

  <link rel="stylesheet" href="/PhotoSwipe/photoswipe.css">
  <link rel="stylesheet" href="/PhotoSwipe/default-skin/default-skin.css">

  <!-- Root element of PhotoSwipe. Must have class pswp. -->
  <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
             It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

      <!-- Container that holds slides.
                PhotoSwipe keeps only 3 of them in the DOM to save memory.
                Don't modify these 3 pswp__item elements, data is added later on. -->
      <div class="pswp__container">
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
      </div>

      <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
      <div class="pswp__ui pswp__ui--hidden">

        <div class="pswp__top-bar">

          <!--  Controls are self-explanatory. Order can be changed. -->

          <div class="pswp__counter"></div>

          <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

          <button class="pswp__button pswp__button--share" title="Share"></button>

          <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

          <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

          <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
          <!-- element will get class pswp__preloader--active when preloader is running -->
          <div class="pswp__preloader">
            <div class="pswp__preloader__icn">
              <div class="pswp__preloader__cut">
                <div class="pswp__preloader__donut"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
          <div class="pswp__share-tooltip"></div>
        </div>

        <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>

        <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

        <div class="pswp__caption">
          <div class="pswp__caption__center"></div>
        </div>
      </div>
    </div>
  </div>

  <script src="/PhotoSwipe/photoswipe.js"></script>
  <script src="/PhotoSwipe/photoswipe-ui-default.js"></script>


<script src="/perfect-scrollbar/js/min/perfect-scrollbar.min.js"></script>
<script src="/scripts/main.js"></script>

</body>
</html>
